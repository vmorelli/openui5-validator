sap.ui.define(["jquery.sap.global","sap/ui/base/Object","sap/ui/core/Control","sap/ui/core/ValueState","sap/ui/core/MessageType","sap/ui/core/message/Message","./thirdparty/ajv-i18n/localize/index","./thirdparty/ajv.min","./library"],function(t,e,r,o,s,a,i){"use strict";const n=["dateValue","selectedKey","selected","value"];const l={$data:true,allErrors:true,coerceTypes:true,errorDataPath:"property"};const u=e.extend("openui5.validator.Validator",{constructor:function(t,r,o,s){if(!t||!r){throw new Error("Missing parameters!")}e.apply(this,arguments);const a=new Ajv(o||l);this._validate=a.compile(r);this._view=t;this._errors=null;this._payload=null;this._validProperties=[];this._language=s;this.addValidProperties(n)}});u.prototype.destroy=function(){this._validate=null;this._view=null;this._errors=null;this._payload=null;this._validProperties=null};u.prototype.validate=function(){const t=this._getControls();this._payload=this._getPayloadToValidate(t);this._clearControlStatus(t);const e=this._validate(this._payload);if(e){this._errors=null}else{if(this._language){i[this._language].localize(this._validate.errors)}this._errors=this._processValidationErrors(this._validate.errors)}return e};u.prototype.getErrors=function(){return this._errors};u.prototype.getPayloadUsedInValidation=function(){return this._payload};u.prototype.getValidProperties=function(){return this._validProperties.map(function t(e){return e})};u.prototype.addValidProperties=function(t){const e=this;t.forEach(function t(r){e._validProperties.push(r)})};u.prototype._getControls=function(){const t=this;let e=[];if(this._validate.schema&&this._validate.schema.properties){e=Object.keys(this._validate.schema.properties).map(function e(o){const s=t._view.byId(o);return s instanceof r?s:null}).filter(function t(e){return e})}return e};u.prototype._getPayloadToValidate=function(t){const e=this;const r={};t.forEach(function t(o){const s=o.getId().lastIndexOf("-")+1;const a=o.getId().substring(s);r[a]=e._getControlValue(o)});return r};u.prototype._getControlValue=function(t){let e=null;const r=Object.keys(t.mProperties);this._validProperties.forEach(function o(s){if(!e){const o=r.find(function t(e){return e===s});if(o){const r=["get",s.substring(0,1).toUpperCase(),s.substring(1)].join("");if(t[r]){e=t[r]();if(t.getMetadata()._sClassName!=="sap.ui.unified.Currency"){e=e[0]}}}}});return e};u.prototype._clearControlStatus=function(t){t.forEach(function t(e){if(e&&e.setValueState){e.setValueState(o.None)}if(e&&e.setValueStateText){e.setValueStateText()}})};u.prototype._setControlErrorStatus=function(t,e){if(t&&t.setValueState){t.setValueState(o.Error)}if(t&&t.setValueStateText){t.setValueStateText(e)}};u.prototype._processValidationErrors=function(t){const e=this;const r=[];t.forEach(function t(o){const s=o.dataPath.substring(1);const a=e._view.byId(s);if(a){e._setControlErrorStatus(a,o.message);r.push(e._createErrorMessageObject(a,o.message,""))}});return r};u.prototype._createErrorMessageObject=function(t,e,r){return new a({message:e,description:r,type:s.Error,target:[t.getId(),"/"].join("")})};return u},true);